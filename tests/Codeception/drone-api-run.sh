#!/usr/bin/env bash

JOOMLA_BASE=$1
HEADER=$(cat <<'EOF'
......._......................._........
......| |.....................| |.......
......| |.___...___.._.__.___.| |.__._..
.._...| |/ _ \./ _ \|  _   _ \| |/ _  |.
.| |__| | (_) | (_) | |.| |.| | | (_) |.
..\____/.\___/.\___/|_|.|_|.|_|_|\__,_|.
........................................
.............__......._____..___........
............/  \.....|  __ \.| |........
.........../ /\ \....| |__) || |........
........../ /__\ \...|  ___/.| |........
........./  ____\ \..| |.....| |........
......../_/......\ \.|_|...._|_|_.......
........................................
...._______........_..._................
...|__   __|......| |.(_)...............
......| |.___..___| |_._._.__...__._....
......| |/ _ \/ __| __| |  _ \./ _  |...
......| |  __/\__ \ |_| | |.| | (_) |...
......|_|\___||___/\__|_|_|.|_|\__  |...
................................__/ |...
...............................|____|...
#
EOF
)

tput setaf 2 -T xterm
echo "-------------------------------"
echo -e "${HEADER}"
echo "-------------------------------"
tput sgr0 -T xterm

# Switch to Joomla base directory
cd $JOOMLA_BASE

# Install Joomla
apache2ctl -D FOREGROUND &
google-chrome --version
chmod 755 libraries/vendor/joomla-projects/selenium-server-standalone/bin/webdrivers/chrome/linux/chromedriver
libraries/vendor/bin/robo run:install --env mysql

# Executing API tests
libraries/vendor/bin/codecept run api --fail-fast --steps --debug
